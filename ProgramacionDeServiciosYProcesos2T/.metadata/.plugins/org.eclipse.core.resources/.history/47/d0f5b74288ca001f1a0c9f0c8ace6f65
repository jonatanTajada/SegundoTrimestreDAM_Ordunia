package com.ejemplo.servidor;

import java.io.*;
import java.net.*;

public class Servidor {
	private static final int PUERTO = 10101;

	public static void main(String[] args) {
		
		try (ServerSocket serverSocket = new ServerSocket(PUERTO)) {
			System.out.println("Servidor escuchando en el puerto " + PUERTO + "...");

			while (true) {
				System.out.println("Esperando conexión...");
				try (Socket clienteSocket = serverSocket.accept()) {
					System.out.println("Cliente conectado desde: " + clienteSocket.getInetAddress());

					// Streams para la comunicación
					BufferedReader entrada = new BufferedReader(new InputStreamReader(clienteSocket.getInputStream()));
					PrintWriter salida = new PrintWriter(clienteSocket.getOutputStream(), true);

					// Leer el número del cliente
					String mensaje = entrada.readLine(); // Leer como String
					if (mensaje != null) {
						int numero = Integer.parseInt(mensaje); // Convertir a entero

						// Calcular el cuadrado y enviar el resultado al cliente
						int cuadrado = numero * numero;
						System.out.println("Número recibido: " + numero + ", su cuadrado es: " + cuadrado);
						salida.println(cuadrado); // Enviar el cuadrado al cliente
					} else {
						System.out.println("El cliente no envió ningún dato.");
					}
				} catch (IOException e) {
					System.err.println("Error en la conexión con el cliente: " + e.getMessage());
				}
			}

		} catch (IOException e) {
			System.err.println("Error en el servidor: " + e.getMessage());
		}
	}
}
